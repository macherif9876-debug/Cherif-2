<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ch√©rif Cr√©ateur - Agence Web</title>
    <style>
        :root { 
            --primary-red: #e53e3e; 
            --primary-blue: #3182ce; 
            --primary-white: #ffffff; 
            --dark-bg: #1a202c; 
            --gray-bg: #f7fafc; 
            --text-dark: #2d3748; 
            --text-light: #4a5568; 
        }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            line-height: 1.6; 
            color: var(--text-dark); 
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-red) 100%); 
            min-height: 100vh; 
            margin: 0; 
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        header { 
            background: rgba(255, 255, 255, 0.95); 
            backdrop-filter: blur(10px); 
            position: fixed; top: 0; left: 0; right: 0; 
            z-index: 1000; 
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1); 
        }
        nav { display: flex; justify-content: space-between; align-items: center; padding: 1rem 1.5rem; }
        .logo { font-size: 1.5rem; font-weight: bold; color: var(--primary-red); display: flex; align-items: center; gap: 10px; }
        .nav-links { display: none; list-style: none; padding: 0; margin: 0; gap: 1.5rem; }
        .nav-links a { text-decoration: none; color: var(--text-dark); font-weight: 600; cursor: pointer; transition: color 0.3s; }
        .nav-links a:hover { color: var(--primary-red); }
        .auth-buttons { display: none; gap: 1rem; }
        .btn { padding: 0.75rem 1.5rem; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s; text-decoration: none; display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem; }
        .btn-primary { background: var(--primary-red); color: white; }
        .btn-primary:hover { background: #c53030; transform: translateY(-2px); box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .btn-secondary { background: transparent; color: var(--primary-blue); border: 2px solid var(--primary-blue); }
        .btn-secondary:hover { background: var(--primary-blue); color: white; }
        main { margin-top: 80px; padding: 2rem 0; }
        .hero { text-align: center; color: white; padding: 2rem 0; }
        .hero h1 { font-size: 2.5rem; margin-bottom: 1rem; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3); }
        .hero p { font-size: 1.1rem; margin-bottom: 1.5rem; opacity: 0.9; }
        .section { display: none; background: white; border-radius: 15px; padding: 2rem; margin: 1.5rem 0; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); }
        .section.active { display: block; animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .section h2 { font-size: 1.5rem; color: var(--primary-red); margin-bottom: 1.5rem; border-bottom: 3px solid var(--primary-blue); padding-bottom: 0.5rem; }
        .portfolio-grid { display: grid; grid-template-columns: 1fr; gap: 1.5rem; }
        .project-card { background: var(--gray-bg); border-radius: 12px; overflow: hidden; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05); display: flex; flex-direction: column; transition: transform 0.3s, box-shadow 0.3s; }
        .project-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        .project-card img { width: 100%; height: 200px; object-fit: cover; }
        .project-card .project-info { padding: 1.5rem; flex-grow: 1; }
        .project-card h3 { color: var(--primary-blue); font-size: 1.25rem; margin-bottom: 0.5rem; }
        .project-card ul { list-style-position: inside; padding-left: 0.5rem; color: var(--text-light); }
        .project-card li { margin-bottom: 0.5rem; }
        .form-group { margin-bottom: 1rem; }
        .form-control { width: 100%; padding: 0.75rem; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 1rem; box-sizing: border-box; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 2000; justify-content: center; align-items: center; }
        .modal.active { display: flex; }
        .modal-content { background: white; padding: 2rem; border-radius: 15px; max-width: 500px; position: relative; width: 90%; max-height: 90vh; overflow-y: auto; }
        .close { position: absolute; top: 1rem; right: 1.5rem; font-size: 2rem; cursor: pointer; color: var(--text-light); }
        .ai-assistant { position: fixed; top: 90px; right: 1.5rem; z-index: 1500; }
        .ai-toggle { width: 50px; height: 50px; border-radius: 50%; background: var(--primary-red); color: white; border: none; cursor: pointer; font-size: 1.5rem; box-shadow: 0 4px 20px rgba(229, 62, 62, 0.3); display:flex; align-items:center; justify-content:center; }
        .ai-chat { display: none; position: absolute; top: 65px; right: 0; width: calc(100vw - 2rem); max-width: 350px; height: 450px; background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2); overflow: hidden; flex-direction: column; }
        .ai-header { background: var(--primary-blue); color: white; padding: 1rem; text-align: center; }
        .ai-messages { flex-grow: 1; overflow-y: auto; padding: 1rem; display: flex; flex-direction: column; gap: 0.75rem; }
        .ai-message { padding: 0.75rem 1rem; border-radius: 18px; max-width: 85%; line-height: 1.4; word-wrap: break-word; }
        .ai-message.user { background: var(--primary-blue); color: white; align-self: flex-end; border-bottom-right-radius: 4px; }
        .ai-message.assistant { background: var(--gray-bg); color: var(--text-dark); align-self: flex-start; border-bottom-left-radius: 4px; }
        .ai-message.typing { color: var(--text-light); font-style: italic; }
        .ai-input { display: flex; padding: 0.75rem; gap: 0.5rem; border-top: 1px solid #e2e8f0; }
        .ai-input input { flex: 1; padding: 0.75rem; border: 1px solid #e2e8f0; border-radius: 20px; font-size: 1rem; }
        .ai-input .btn { padding: 0.75rem; min-width: 44px; }
        .btn#aiVoice.is-listening { background-color: #c53030; color: white; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(229, 62, 62, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(229, 62, 62, 0); } 100% { box-shadow: 0 0 0 0 rgba(229, 62, 62, 0); } }
        .hamburger-menu { display: block; cursor: pointer; z-index: 1200; }
        .hamburger-menu div { width: 25px; height: 3px; background-color: var(--text-dark); margin: 5px 0; transition: 0.4s; }
        .mobile-nav { position: fixed; top: 0; left: -100%; width: 80%; height: 100vh; background: white; z-index: 1100; transition: left 0.5s ease; padding-top: 6rem; box-shadow: 5px 0px 15px rgba(0,0,0,0.1); }
        .mobile-nav.active { left: 0; }
        .mobile-nav ul { list-style: none; padding: 0; text-align: center; }
        .mobile-nav ul li { margin-bottom: 2rem; }
        .mobile-nav ul a { font-size: 1.5rem; text-decoration: none; color: var(--text-dark); font-weight: 600; cursor: pointer; }
        .mobile-auth { text-align: center; margin-top: 2rem; display: flex; flex-direction: column; gap: 1rem; padding: 0 2rem; }
        @media (min-width: 768px) { .nav-links, .auth-buttons { display: flex; } .hamburger-menu { display: none; } .hero h1 { font-size: 3.5rem; } .portfolio-grid { grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); } .contact-info { flex-direction: row; justify-content: center; } }
        .notice-box { text-align: center; margin-bottom: 2rem; padding: 1rem; background-color: #ebf8ff; border-left: 4px solid var(--primary-blue); border-radius: 8px; }
        .notice-box p { font-weight: 600; color: var(--text-dark); }
        .notice-box span { font-style: italic; color: var(--text-light); margin-top: 0.5rem; display: block;}
        /* STYLES POUR LES CONTACTS */
        .contact-container { margin-top: 2rem; text-align: center; background-color: var(--gray-bg); padding: 2rem; border-radius: 12px; }
        .contact-info { display: flex; flex-direction: column; gap: 1.5rem; align-items: center; }
        .contact-item { display: flex; align-items: center; gap: 1rem; font-size: 1.1rem; }
        .contact-item svg { width: 24px; height: 24px; color: var(--primary-blue); flex-shrink: 0; }
        .contact-item a { color: var(--text-dark); text-decoration: none; font-weight: 600; }
        .contact-item a:hover { text-decoration: underline; color: var(--primary-red); }
        .phone-numbers { display: flex; flex-direction: column; align-items: flex-start; gap: 0.5rem; }
    </style>
</head>
<body>
    <header>
        <nav>
            <div class="logo">üé® Ch√©rif Cr√©ateur</div>
            <ul class="nav-links">
                <li><a data-section="home">Accueil</a></li>
                <li><a data-section="portfolio">Portfolio</a></li>
                <li><a data-section="services">Services</a></li>
                <li><a data-section="commandes">Contact</a></li>
            </ul>
            <div class="auth-buttons" id="auth-buttons-desktop"></div>
            <!-- Le menu "hamburger" pour afficher la navigation sur mobile -->
            <div class="hamburger-menu" id="hamburger-btn"><div></div><div></div><div></div></div>
        </nav>
    </header>

    <div class="mobile-nav" id="mobile-menu">
        <ul>
            <li><a data-section="home">Accueil</a></li>
            <li><a data-section="portfolio">Portfolio</a></li>
            <li><a data-section="services">Services</a></li>
            <li><a data-section="commandes">Contact</a></li>
        </ul>
        <!-- Les boutons de connexion/inscription pour mobile apparaissent ici -->
        <div class="mobile-auth" id="auth-buttons-mobile"></div>
    </div>

    <main class="container">
        <section class="hero">
            <h1>Bienvenue chez Ch√©rif Cr√©ateur</h1>
            <p>Votre agence de cr√©ation de sites web professionnels</p>
            <a href="#" class="btn btn-primary" data-section="services">D√©couvrir nos offres</a>
        </section>

        <section id="home" class="section active">
            <h2>üè† Accueil</h2><p>D√©couvrez nos services de cr√©ation de sites web sur mesure. Nous transformons vos id√©es en r√©alit√©s digitales avec un design moderne et des fonctionnalit√©s avanc√©es pour propulser votre activit√©.</p>
        </section>
        <section id="portfolio" class="section">
            <h2>üíº Portfolio</h2><div class="portfolio-grid" id="portfolioGrid"><p>Nos projets r√©cents seront affich√©s ici.</p></div>
        </section>
        
        <section id="services" class="section">
            <h2>üõ†Ô∏è Nos Offres - Des Solutions Sur Mesure</h2>
            <div class="notice-box">
                <p>Un acompte de 50% est requis pour d√©buter chaque projet.</p>
                <span>Votre satisfaction est notre priorit√© : Remboursement garanti !</span>
            </div>
            <div class="portfolio-grid">
                <div class="project-card"><img src="https://placehold.co/600x400/3182ce/ffffff?text=Site+Vitrine+Pro" alt="Exemple de site vitrine"><div class="project-info"><h3>Offre Essentiel</h3><p><strong>250 000 Francs CFA</strong></p><ul><li>‚úîÔ∏è Site vitrine (5 pages)</li><li>‚úîÔ∏è Design adaptatif (mobile/ordinateur)</li><li>‚úîÔ∏è Formulaire de contact</li></ul></div></div>
                <div class="project-card"><img src="https://placehold.co/600x400/e53e3e/ffffff?text=Site+de+R%C3%A9servation" alt="Exemple de site de r√©servation"><div class="project-info"><h3>Offre Avanc√©</h3><p><strong>500 000 Francs CFA</strong></p><ul><li>‚úîÔ∏è Tout de l'offre Essentiel</li><li>‚úîÔ∏è Syst√®me de r√©servation (tables, RDV...)</li><li>‚úîÔ∏è Blog / Section d'actualit√©s</li></ul></div></div>
                <div class="project-card"><img src="https://placehold.co/600x400/1a202c/ffffff?text=Application+Compl%C3%A8te" alt="Exemple d'application compl√®te"><div class="project-info"><h3>Offre Premium</h3><p><strong>1 500 000 Francs CFA</strong></p><ul><li>‚úîÔ∏è Application sur mesure</li><li>‚úîÔ∏è 3 interfaces : Admin, Employ√©, Client</li><li>‚úîÔ∏è Paiement en ligne (Orange Money, Wave)</li><li>‚úîÔ∏è Suivi de commande/livraison en temps r√©el</li><li>‚úîÔ∏è <strong>Assistant IA "Ch√©rif"</strong></li></ul></div></div>
            </div>
        </section>
        
        <section id="commandes" class="section">
            <h2>üìã Contact & Commandes</h2>
            <p>Discutons de votre projet ! Contactez-nous directement pour obtenir un devis personnalis√© ou pour toute autre question.</p>
            <div class="contact-container">
                <div class="contact-info">
                    <div class="contact-item">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
                        <a href="mailto:Macherif9876@gmail.com">Macherif9876@gmail.com</a>
                    </div>
                    <div class="contact-item">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>
                        <div class="phone-numbers">
                            <a href="tel:+221705491330">+221 70 549 13 30</a>
                            <a href="tel:+221705966696">+221 70 596 66 96</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="admin" class="section">
            <h2>‚öôÔ∏è Panneau Administrateur</h2><p>G√©rez les clients et les projets ici.</p>
        </section>
    </main>

    <div id="loginModal" class="modal"><div class="modal-content"><span class="close" data-modal="loginModal">&times;</span><h2>Connexion</h2><form id="loginForm"><div class="form-group"><label for="loginEmail">Email</label><input type="email" id="loginEmail" class="form-control" required></div><div class="form-group"><label for="loginPassword">Mot de passe</label><input type="password" id="loginPassword" class="form-control" required></div><p id="loginError" style="color:red;"></p><button type="submit" class="btn btn-primary">Se connecter</button></form></div></div>
    <div id="registerModal" class="modal"><div class="modal-content"><span class="close" data-modal="registerModal">&times;</span><h2>Cr√©er un Compte</h2><form id="registerForm"><div class="form-group"><label for="registerName">Nom</label><input type="text" id="registerName" class="form-control" required></div><div class="form-group"><label for="registerEmail">Email</label><input type="email" id="registerEmail" class="form-control" required></div><div class="form-group"><label for="registerPassword">Mot de passe</label><input type="password" id="registerPassword" class="form-control" minlength="6" required></div><p id="registerError" style="color:red;"></p><button type="submit" class="btn btn-primary">Cr√©er le compte</button></form></div></div>
    
    <div class="ai-assistant">
        <button id="ai-toggle" class="ai-toggle">ü§ñ</button>
        <div class="ai-chat" id="aiChat">
            <div class="ai-header"><h3>Ch√©rif - Assistant IA</h3></div>
            <div class="ai-messages" id="aiMessages"></div>
            <div class="ai-input">
                <input type="text" id="aiInput" placeholder="Posez une question...">
                <button class="btn btn-primary" id="aiSend" aria-label="Envoyer">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
                </button>
                <button class="btn btn-secondary" id="aiVoice" aria-label="Entr√©e vocale">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="23"></line></svg>
                </button>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc, getDocs, collection } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // --- VOTRE CL√â FIREBASE EST CONNECT√âE ---
        const firebaseConfig = {
          apiKey: "AIzaSyAoFjRPn87t2diyyEUmoZ7qIS5jrPhN81k",
          authDomain: "cherif-1-d8bdf.firebaseapp.com",
          projectId: "cherif-1-d8bdf",
          storageBucket: "cherif-1-d8bdf.appspot.com",
          messagingSenderId: "451223510905",
          appId: "1:451223510905:web:5a2c930dca14de62dd59a8",
          measurementId: "G-YCPV1S8CVK"
        };
        
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        const sections = document.querySelectorAll('.section');
        const authButtonsDesktop = document.getElementById('auth-buttons-desktop');
        const authButtonsMobile = document.getElementById('auth-buttons-mobile');
        const hamburgerBtn = document.getElementById('hamburger-btn');
        const mobileMenu = document.getElementById('mobile-menu');

        hamburgerBtn.addEventListener('click', () => mobileMenu.classList.toggle('active'));
        function closeMobileMenu() { mobileMenu.classList.remove('active'); }
        document.querySelectorAll('.mobile-nav a, .nav-links a, .hero a').forEach(link => {
            link.addEventListener('click', (e) => { 
                e.preventDefault();
                showSection(link.dataset.section); 
                closeMobileMenu(); 
            });
        });

        function showSection(sectionId) { if (!sectionId) return; sections.forEach(s => s.classList.remove('active')); const section = document.getElementById(sectionId); if(section) section.classList.add('active'); }
        window.showModal = (id) => { document.getElementById(id).classList.add('active'); closeMobileMenu(); }
        window.closeModal = (id) => document.getElementById(id).classList.remove('active');
        document.querySelectorAll('.close').forEach(btn => btn.addEventListener('click', () => closeModal(btn.dataset.modal)));

        // --- AM√âLIORATION: Logique plus robuste pour les boutons de connexion ---
        function createAuthButton(text, className, onClick) {
            const button = document.createElement('a');
            button.href = '#';
            button.className = `btn ${className}`;
            button.textContent = text;
            button.addEventListener('click', (e) => {
                e.preventDefault();
                onClick();
            });
            return button;
        }

        function updateAuthUI(user, isAdmin) {
            authButtonsDesktop.innerHTML = '';
            authButtonsMobile.innerHTML = '';

            if (user && !user.isAnonymous) {
                // Utilisateur connect√©
                if (isAdmin) {
                    authButtonsDesktop.appendChild(createAuthButton('Admin', 'btn-secondary', () => showSection('admin')));
                    authButtonsMobile.appendChild(createAuthButton('Admin', 'btn-secondary', () => { showSection('admin'); closeMobileMenu(); }));
                }
                authButtonsDesktop.appendChild(createAuthButton('D√©connexion', 'btn-primary', () => signOut(auth)));
                authButtonsMobile.appendChild(createAuthButton('D√©connexion', 'btn-primary', () => { signOut(auth); closeMobileMenu(); }));
            } else {
                // Utilisateur d√©connect√©
                authButtonsDesktop.appendChild(createAuthButton('Connexion', 'btn-secondary', () => showModal('loginModal')));
                authButtonsDesktop.appendChild(createAuthButton("S'inscrire", 'btn-primary', () => showModal('registerModal')));
                
                authButtonsMobile.appendChild(createAuthButton('Connexion', 'btn-secondary', () => { showModal('loginModal'); closeMobileMenu(); }));
                authButtonsMobile.appendChild(createAuthButton("S'inscrire", 'btn-primary', () => { showModal('registerModal'); closeMobileMenu(); }));
            }
        }
        
        onAuthStateChanged(auth, async (user) => {
            if (user && !user.isAnonymous) {
                const userDoc = await getDoc(doc(db, "users", user.uid));
                const isAdmin = userDoc.exists() && userDoc.data().role === 'admin';
                updateAuthUI(user, isAdmin);
            } else {
                updateAuthUI(null, false);
            }
        });

        document.getElementById('registerForm').addEventListener('submit', async e => {
            e.preventDefault();
            const name = document.getElementById('registerName').value, email = document.getElementById('registerEmail').value, password = document.getElementById('registerPassword').value, errorEl = document.getElementById('registerError');
            errorEl.textContent = '';
            try {
                const usersCollection = collection(db, "users");
                const usersSnapshot = await getDocs(usersCollection);
                const role = usersSnapshot.empty ? 'admin' : 'client';
                const cred = await createUserWithEmailAndPassword(auth, email, password);
                await setDoc(doc(db, "users", cred.user.uid), { name, email, role });
                closeModal('registerModal');
            } catch (error) { errorEl.textContent = "Erreur: " + error.message; }
        });

        document.getElementById('loginForm').addEventListener('submit', async e => {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value, password = document.getElementById('loginPassword').value, errorEl = document.getElementById('loginError');
            errorEl.textContent = '';
            try { await signInWithEmailAndPassword(auth, email, password); closeModal('loginModal'); } catch (error) { errorEl.textContent = "Email ou mot de passe incorrect."; }
        });
        
        // --- LOGIQUE POUR L'ASSISTANT IA (AVEC VOTRE CL√â) ---
        const aiToggle = document.getElementById('ai-toggle');
        const aiChat = document.getElementById('aiChat');
        const aiMessages = document.getElementById('aiMessages');
        const aiInput = document.getElementById('aiInput');
        const aiSend = document.getElementById('aiSend');
        const aiVoice = document.getElementById('aiVoice');
        
        aiToggle.addEventListener('click', () => {
            const isOpening = aiChat.style.display !== 'flex';
            aiChat.style.display = isOpening ? 'flex' : 'none';
            if (isOpening && aiMessages.children.length === 0) {
                 const welcomeMsg = "Bienvenue ! Je suis Ch√©rif, votre assistant. Posez-moi une question sur nos offres.";
                 addAIMessage("assistant", welcomeMsg);
                 speakText(welcomeMsg);
            }
        });
        
        aiSend.addEventListener('click', sendAIMessage);
        aiInput.addEventListener('keyup', e => { if (e.key === 'Enter') sendAIMessage(); });

        function addAIMessage(sender, text) { 
            const msgDiv = document.createElement('div'); 
            msgDiv.className = `ai-message ${sender}`; 
            msgDiv.textContent = text; 
            aiMessages.appendChild(msgDiv); 
            aiMessages.scrollTop = aiMessages.scrollHeight;
            return msgDiv;
        }
        
        function speakText(text) { 
            if ('speechSynthesis' in window) { 
                speechSynthesis.cancel(); 
                const utterance = new SpeechSynthesisUtterance(text); 
                utterance.lang = 'fr-FR'; 
                speechSynthesis.speak(utterance); 
            } 
        }
        
        async function getAIResponse(prompt) {
            // Votre cl√© API est maintenant int√©gr√©e et active.
            const apiKey = "AIzaSyBC4ebYhYeTTVZtH6HodRrXqKCpEPGGkgs"; 

            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
            const systemPrompt = "Vous √™tes Ch√©rif, l'assistant IA de l'agence web 'Ch√©rif Cr√©ateur'. Vous √™tes amical, professionnel et vous r√©pondez aux questions sur le d√©veloppement web, les services et les prix de l'agence (Offre Essentiel √† 250 000 FCFA, Avanc√© √† 500 000 FCFA, Premium √† 1 500 000 FCFA). Expliquez les choses simplement et poliment en fran√ßais.";
            
            try {
                const response = await fetch(apiUrl, { 
                    method: 'POST', 
                    headers: { 'Content-Type': 'application/json' }, 
                    body: JSON.stringify({ 
                        contents: [{ parts: [{ text: prompt }] }], 
                        systemInstruction: { parts: [{ text: systemPrompt }] }, 
                    }) 
                });
                if (!response.ok) {
                    const errorBody = await response.json();
                    console.error("API Error Response:", errorBody);
                    if (response.status === 400) throw new Error(`Cl√© API invalide ou requ√™te malform√©e. V√©rifiez la cl√© dans Google AI Studio.`);
                    throw new Error(`Erreur de communication avec l'API (${response.status})`);
                }
                const result = await response.json();
                
                if (!result.candidates || !result.candidates[0].content || !result.candidates[0].content.parts[0].text) {
                     return "L'assistant a donn√© une r√©ponse inattendue. Veuillez reformuler.";
                }
                return result.candidates[0].content.parts[0].text;
            } catch (error) { 
                console.error("Erreur IA:", error); 
                return `D√©sol√©, une erreur technique est survenue: ${error.message}`; 
            }
        }
        
        async function sendAIMessage() {
            const userText = aiInput.value.trim();
            if (userText === "") return;

            addAIMessage('user', userText);
            aiInput.value = '';
            
            const typingIndicator = addAIMessage('assistant typing', 'Ch√©rif est en train d\'√©crire...');
            
            const responseText = await getAIResponse(userText);
            
            aiMessages.removeChild(typingIndicator);
            addAIMessage('assistant', responseText);
            speakText(responseText);
        }

        aiVoice.addEventListener('click', () => {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            if (!SpeechRecognition) { 
                addAIMessage('assistant', 'D√©sol√©, la reconnaissance vocale n\'est pas support√©e sur votre navigateur.'); 
                return; 
            }
            
            if (aiVoice.classList.contains('is-listening')) return;

            const recognition = new SpeechRecognition();
            recognition.lang = 'fr-FR';
            
            recognition.onstart = () => { aiVoice.classList.add('is-listening'); aiInput.placeholder = "Je vous √©coute..."; };
            recognition.onend = () => { aiVoice.classList.remove('is-listening'); aiInput.placeholder = "Posez une question..."; };
            recognition.onresult = (event) => { aiInput.value = event.results[0][0].transcript; sendAIMessage(); };
            recognition.onerror = (event) => { 
                console.error("Erreur de reconnaissance vocale:", event.error);
                addAIMessage('assistant', `Une erreur est survenue avec le micro: ${event.error}. Assurez-vous d'avoir donn√© la permission.`); 
            };
            recognition.start();
        });

        showSection('home');
    </script>
</body>
</html>